<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.6">
  <compounddef id="md_README" kind="page">
    <compoundname>md_README</compoundname>
    <title>ASCO Aerial Autonomy</title>
    <detaileddescription>
<para><heading level="2">Introduction</heading>
</para><para>The doxygen documentation to the project can be found <ulink url="https://jhu-asco.github.io/aerial_autonomy/">here</ulink>.</para><para><heading level="2">Setup</heading>
</para><para>Run the setup script in scripts/setup/setup.sh to configure Git hooks.</para><para>Install the following dependencies (lcov, protobuf, doxygen, doxypy, coverxygen, google-glog, class-loader). On Ubuntu 14.04 run the following line in a terminal <verbatim>sudo apt-get install lcov protobuf-compiler libprotobuf-dev doxygen doxypy libgoogle-glog-dev ros-indigo-class-loader
sudo pip install coverxygen
</verbatim></para><para>Install protobuf 3.1: <verbatim>git clone https://github.com/google/protobuf.git
cd protobuf
git checkout v3.1.0
./autogen.sh
./configure
make
sudo make install
sudo ldconfig
</verbatim></para><para><heading level="2">Running Executables</heading>
</para><para>The package provides a <computeroutput>uav_system_node</computeroutput> executable which loads a state machine and hardware and waits for event commands from a ROS topic. The <computeroutput>rqt_aerial_autonomy_gui</computeroutput> script provides a GUI to generate events for the state machine. The rqt plugin can be loaded along with <computeroutput>rqt_rviz</computeroutput> in the <computeroutput>rqt_gui</computeroutput> framework.</para><para>The <computeroutput>simulator.launch</computeroutput> file in the launch folder executes the state machine node using simulated hardware. The GUI can be launched individually using rosrun. The steps to launch a simulated quadrotor with the state machine are <verbatim>roslaunch aerial_autonomy simulator.launch
rosrun aerial_autonomy rqt_aerial_autonomy_gui  # In a separate tab
</verbatim></para><para><heading level="2">Running Tests</heading>
</para><para>To build and run tests use <computeroutput>catkin build <ref refid="namespaceaerial__autonomy" kindref="compound">aerial_autonomy</ref> --catkin-make-args run_tests</computeroutput>. Output of individual tests can be checked using <computeroutput>rosrun <ref refid="namespaceaerial__autonomy" kindref="compound">aerial_autonomy</ref> test_name</computeroutput>. To see all test outputs run <computeroutput>catkin run_tests --this</computeroutput>.</para><para><heading level="2">Logging</heading>
</para><para>GLOG is used to log messages from the state machine. The messages are divided into different levels (INFO, WARNING, ERROR, etc.,). The information messages are divided into different verbosity levels (0,1,2 and so on). The verbosity level can be adjusted using the environment variable <computeroutput>GLOG_v</computeroutput>. If the environment variable is set to 1 (<computeroutput>export GLOG_v=1</computeroutput>), then all the messages with verbosity 0 and 1 are streamed to stderr output.</para><para>The log messages are also recorded into log files in the <computeroutput>logs</computeroutput> folder. The symbolic links <computeroutput>uav_system_node.INFO</computeroutput> and <computeroutput>uav_system_node.WARNING</computeroutput> in the log folder point to the latest log files. The log directory can be changed using the <computeroutput>GLOG_log_dir</computeroutput> environment variable. More information about the log files can be found in the Google Log <ulink url="http://rpg.ifi.uzh.ch/docs/glog.html">documentation</ulink>.</para><para>The <computeroutput>simulator</computeroutput> launch file introduced above allows for specifying the log level and log directory using roslaunch arguments <computeroutput>log_level</computeroutput> and <computeroutput>log_dir</computeroutput> respectively. For example <verbatim>roslaunch aerial_autonomy simulator.launch log_level:=1  # Prints all the verbose log messages with priority 0 and 1.
</verbatim></para><para><heading level="2">Style</heading>
</para><para>This repository uses clang-format for style checking. Pre-commit hooks ensure that all staged files conform to the style conventions. To skip pre-commit hooks and force a commit, use <computeroutput>git commit -n</computeroutput>.</para><para><heading level="2">Documentation Coverage</heading>
</para><para>We use coverxygen to generate documentation coverage for the doc: <ulink url="https://github.com/psycofdj/coverxygen">https://github.com/psycofdj/coverxygen</ulink></para><para>Use the script <computeroutput>scripts/generate_documentation_coverage.bash</computeroutput> to generate documentation into <computeroutput>documentation_coverage_info</computeroutput> folder. Check the html page in <computeroutput>documentation_coverage_info/index.html</computeroutput> to verify the documentation coverage of the code.</para><para>Documentation coverage is also added as a <computeroutput>pre-push</computeroutput> hook. This verifies that 95% of the code is covered with documentation before pushing to remote. It can be skipped for branches with their name starting with <computeroutput>develop*</computeroutput> and also by using <computeroutput>git push --no-verify</computeroutput> command.</para><para><heading level="2">Test Coverage</heading>
</para><para>We use <computeroutput>lcov</computeroutput> to generate the test coverage report into the <computeroutput>test_coverage_info</computeroutput> folder. The script <computeroutput>scripts/generate_test_coverage.bash</computeroutput> is used to run tests in the project and generate test coverage report into <computeroutput>test_coverage_info</computeroutput> folder. The script is generated using CMake. Run <computeroutput>catkin build <ref refid="namespaceaerial__autonomy" kindref="compound">aerial_autonomy</ref></computeroutput> to create the script. Check the html page <computeroutput>test_coverage_info/index.html</computeroutput> to check the line and function coverage. The bash script is generated by running CMake using <computeroutput>catkin build <ref refid="namespaceaerial__autonomy" kindref="compound">aerial_autonomy</ref></computeroutput>.</para><para>The test generation is integrated into the <computeroutput>pre-push</computeroutput> commit hook. This runs the above test coverage generation script and verifies that the coverage level is above 95% threshold. This can be skipped by either naming the branch as <computeroutput>develop[your_branch_name]</computeroutput> or using <computeroutput>git push --no-verify</computeroutput>.</para><para><heading level="2">Uploading documentation</heading>
</para><para>The documentation is uploaded through <computeroutput>gh-pages</computeroutput> branch. The docs are created in master and passed to the <computeroutput>gh-pages</computeroutput> branch using <computeroutput>scripts/applydocs.bash</computeroutput> script. The script checks that there are not uncommited changes before uploading documentation to avoid issues with git. The script also requires that you explicitly link gh-pages branch to the remote using <computeroutput>git branch --set-upstream-to=[GH_PAGES_REMOTE]</computeroutput> </para>    </detaileddescription>
  </compounddef>
</doxygen>
